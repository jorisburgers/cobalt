<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
  <title>Cobalt :: Constraint-Based Little Typechecker</title>
  
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap-theme.min.css">
  <!-- <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script> -->

  <script src="http://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
  <script src="http://cdnjs.cloudflare.com/ajax/libs/ace/1.1.3/ace.js"></script>

  <link rel="stylesheet" href="bootstrap-treeview.min.css">
  <script src="bootstrap-treeview.min.js"></script>
  
  <style>
  #editor {
    height: 400px;
  }
  
  #tc-button {
    width: 96%;
    margin-left: 2%;
    margin-right: 2%;
    margin-top: 10px;
  }

  #error-msg, .list-group {
    font-family: Menlo,Monaco,Consolas,monospace;
  }
  </style>
</head>
<body>
  <a href="https://github.com/serras/cobalt"><img style="position: absolute; top: 0; right: 0; border: 0; z-index: 100;" src="https://camo.githubusercontent.com/e7bbb0521b397edbd5fe43e7f760759336b5e05f/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f677265656e5f3030373230302e706e67" alt="Fork me on GitHub" data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_right_green_007200.png"></a>
  
  <div class="container-fluid">
    <h1>Cobalt <small>:: Constraint-Based Little Typechecker</small></h1>
    <div class="row">
      <div class="col-md-6">
        <div id="editor"></div>
        <div><button type="button" class="btn btn-primary" id="tc-button">Typecheck!</button></div>
      </div>
      <div class="col-md-6">
        <div class="panel panel-danger" id="error-panel">
          <div class="panel-heading">Parsing error</div>
          <div class="panel-body" id="error-msg"></div>
        </div>
        <div class="panel panel-info" id="result-panel">
          <div class="panel-heading">Typechecker result</div>
          <div class="panel-body" id="result"></div>
        </div>
      </div>
    </div>
  </div>
  
  <script>
    var editor = ace.edit("editor");
    editor.setTheme("ace/theme/chrome");
    editor.getSession().setMode("ace/mode/haskell");
    editor.setFontSize(16);
    editor.setShowPrintMargin(false);
    // Initially hide all panels
    $("#error-panel").hide();
    $("#result-panel").hide();
    // On "Typecheck" click
    $("#tc-button").click(function() {
      $.post("/typecheck", { code : editor.getValue() }, function (data) {
        if (data.status == "error") {
          $("#result-panel").hide();
          $("#error-panel").show();
          $("#error-msg").text(data.message);
        } else {
          $("#error-panel").hide();
          $("#result-panel").show();
          $("#result").treeview({ data : data.values
                                , showTags : true
                                , levels : 1
                                , highlightSelected : false
                                , nodeIcon : ""
                                , showBorder : false });
        }
      }, "json");
    });
  </script>
</body>
</html>
